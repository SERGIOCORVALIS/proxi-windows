
Утилита для удобного управления системным прокси в Windows через меню.

## Что сделано в этом аудите

- Упрощена структура: оставлен один рабочий скрипт `my_proxy.py`.
- Удалены дубли и временные файлы.
- Добавлено интерактивное меню для повседневного использования.
- Реализовано включение/выключение прокси сразу в двух контурах:
  - **WinINET** (браузеры и часть desktop-приложений).
  - **WinHTTP** (службы и системные компоненты Windows).

> Важно: «весь Windows через прокси» на практике зависит от конкретных приложений.
> Этот скрипт покрывает оба основных системных механизма. Для приложений,
> которые игнорируют системные настройки, может понадобиться отдельная
> конфигурация в самом приложении.

## Быстрый старт

1. Запусти PowerShell **от имени администратора** (рекомендуется).
2. Перейди в папку проекта.
3. Запусти:

```powershell
python my_proxy.py
```

4. В меню:
   - сначала выбери `1` и задай `host:port` твоего прокси;
   - затем `2`, чтобы включить проксирование;
   - `4` для проверки статуса;
   - `3`, чтобы выключить.

## Где хранятся настройки

Скрипт создаёт рядом файл `proxy_settings.json` с полями:

- `host`
- `port`
- `bypass`

Пример:

```json
{
  "host": "127.0.0.1",
  "port": 1080,
  "bypass": "localhost;127.*;10.*;172.16.*;192.168.*;<local>"
}
```

## Полезно знать

- Для WinHTTP нужны права администратора.
- Если админ-прав нет, WinINET может включиться, а WinHTTP — нет.
- После изменения настроек иногда нужно перезапустить отдельные приложения.
